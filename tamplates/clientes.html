{% extends 'base.html' %}

{% block content %}
<h1>Lista de Clientes</h1>

 <div  class="space-y-8">

    <div  class="mb-8">
        <div class="mb-4 flex justify-end">
        <a href="{% url 'adicionar_cliente' %}" 
            class="bg-green-600 text-white font-semibold px-5 py-2 rounded-xl hover:bg-green-700 transition shadow">
        + Adicionar Cliente
        </a>
        </div>
    </div>


    <div  class="mb-8">
        <form method="get" class="p-4 mb-6 rounded-2xl shadow bg-white flex flex-wrap gap-6 items-end" style="border: 2px solid #28a745;">
        <!-- Filtro por nome -->
        <div class="flex flex-col" style="width: 160px;">
        <label for="nome" class="text-green-700 font-semibold mb-1">Nome</label>
        <input type="text" id="nome" name="nome" value="{{ request.GET.nome }}" 
                class="rounded-xl px-3 py-1 border border-green-400 text-green-800 w-full focus:outline-none focus:ring-2 focus:ring-green-500" 
                placeholder="Buscar...">
        </div>

        <!-- Filtro por status -->
        <div class="flex flex-col" style="min-width: 180px;">
        <label for="status" class="text-green-700 font-semibold mb-1">Status</label>
        <select id="status" name="status" 
                class="rounded-xl px-3 py-1 border border-green-400 text-green-800 w-full focus:outline-none focus:ring-2 focus:ring-green-500">
            <option value="">Todos</option>
            {% for value, label in status_choices %}
            <option value="{{ value }}" {% if request.GET.status == value %}selected{% endif %}>{{ label }}</option>
            {% endfor %}
        </select>
        </div>

        <!-- Filtro por devendo -->
        <div class="flex flex-col" style="min-width: 180px;">
        <label for="devendo" class="text-green-700 font-semibold mb-1">Devendo?</label>
        <select id="devendo" name="devendo" 
                class="rounded-xl px-3 py-1 border border-green-400 text-green-800 w-full focus:outline-none focus:ring-2 focus:ring-green-500">
            <option value="">Todos</option>
            <option value="sim" {% if request.GET.devendo == "sim" %}selected{% endif %}>Sim</option>
            <option value="nao" {% if request.GET.devendo == "nao" %}selected{% endif %}>Não</option>
        </select>
        </div>

        <!-- Botões -->
        <div class="flex gap-2 items-end" style="min-width: 220px;">
        <button type="submit" class="bg-green-600 text-white font-semibold px-4 py-2 rounded-xl hover:bg-green-700 transition w-full">
            Filtrar
        </button>
        <a href="{% url 'listar_clientes' %}" class="bg-white text-green-700 font-semibold px-4 py-2 border border-green-500 rounded-xl hover:bg-green-50 transition w-full text-center">
            Limpar
        </a>
        </div>
        </form>
    </div>


    <div  class="mb-8">
        <form method="post">
            {% csrf_token %}
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Nome</th>
                        <th>E-mail</th>
                        <th>Plano</th>
                        <th>telefone</th>
                        <th>endereço</th>
                        <th>Devendo</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for cliente in clientes %}
                    <tr>
                        <td>{{ cliente.id }}</td>
                        <td>
                            <input type="text" name="nome_{{ cliente.id }}" value="{{ cliente.nome }}">
                        </td>
                        <td>
                            <input type="email" name="email_{{ cliente.id }}" 
                                {% if cliente.email %}
                                    value="{{ cliente.email }}"
                                {% else %}
                                    placeholder="Digite o e-mail">
                                {% endif %}
                        </td>
                        <td>
                            <select name="plano_{{ cliente.id }}">
                                {% for value, label in planos_choices %}
                                    <option value="{{ value }}" {% if cliente.plano == value %}selected{% endif %}>{{ label }}</option>
                                {% endfor %}
                            </select>
                        </td>
                        
                        <td>
                            <input type="text" name="telefone_{{ cliente.id }}" value="{{ cliente.telefone }}">
                        </td>
                        
                        <td>
                            <input type="text" name="endereco_{{ cliente.id }}" value="{{ cliente.endereco}}">
                        </td>
                        
                        <td>
                            <input type="checkbox" name="devendo_{{ cliente.id }}" {% if cliente.devendo %}checked{% endif %}>
                        </td>

                        <td>
                            <button type="submit" name="atualizar" value="{{ cliente.id }}">Salvar</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </form>
    </div>

</div>


{% endblock %}
